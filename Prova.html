<html>
	<canvas id="gameCanvas" width="800"
	height="600"></canvas>

	<script type="text/javascript">
		var canvas;
		var canvasContext;
		var MIDAQUADRAT = 15; 
		var deltapos = 4; //Augment de la posicio cada interval si esta clicant
		var posX = 100;
		var posY = 100;
		var keyState = {};


		window.onload = function() {
			canvas = document.getElementById('gameCanvas');
			canvasContext = canvas.getContext('2d');
		    
		    /*
			setInterval(function() {
	            drawEverything();
			}, 1000);
			*/
			gameLoop();
		}


		//CALCUL POSICIO QUADRAT

		//https://stackoverflow.com/questions/12273451/how-to-fix-delay-in-javascript-keydown

		window.addEventListener('keydown',function(e){
    		keyState[e.keyCode || e.which] = true;
		},true);    
		window.addEventListener('keyup',function(e){
   	 		keyState[e.keyCode || e.which] = false;
		},true);

		/*function mouQuadrat() {

			if (keyState[37]) posX -= deltapos;
			if (keyState[38]) posY -= deltapos;
			if (keyState[39]) posX += deltapos;
			if (keyState[40]) posY += deltapos;
			
			/*keyID = e.keyCode;
			console.log(keyID + " " + posY + " " + posX);

			switch(keyID) {
				case :
					posX -= deltapos;
					break;
				case 38:
					posY -= deltapos;
					break;
				case 39:
					posX += deltapos;
					break;
				case 40:
					posY += deltapos;
					break;
			}
		}*/

		function gameLoop() {
		    if (keyState[37]) posX -= deltapos;
			if (keyState[38]) posY -= deltapos;
			if (keyState[39]) posX += deltapos;
			if (keyState[40]) posY += deltapos;
		    
		    drawEverything();
		    setTimeout(gameLoop, 10);

		}

		//DIBUIX DEL CANVAS
		function drawEverything() {
			canvasContext.fillStyle = 'black';
			canvasContext.fillRect(0,0, canvas.width, canvas.height);
			colorRect(posX, posY, MIDAQUADRAT, MIDAQUADRAT, 'white');
		}

		function colorRect(posX, posY, width, height, color) {
   			canvasContext.fillStyle = color;
   		 	canvasContext.fillRect(posX, posY, width, height);
		}

	</script>
</html>